<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bilder-Galerie | Barbara Baumann</title>
<link rel="stylesheet" href="../style.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;0,800;0,900;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
</head>
<body>

<!-- Main Header -->
<header class="header-main">
  <div class="container">
    <div class="header-content">
      <div class="logo">
        <img src="../logo.png" alt="Barbara Baumann Logo">
      </div>
      <nav>
        <ul class="navigation">
          <li><a href="/">Home</a></li>
          <li><a href="/bilder-galerie/" class="current">Bilder-Galerie</a></li>
          <li><a href="/malstil/">Malstil</a></li>
          <li><a href="/biografie/">Biografie</a></li>
          <li><a href="/kontakt/">Kontakt</a></li>
        </ul>
      </nav>
      <button class="mobile-menu-toggle">
        <div class="hamburger">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </button>
    </div>
  </div>
</header>

<!-- Fixed Header -->
<header class="header-fixed">
  <div class="container">
    <div class="header-content">
      <nav>
        <ul class="navigation">
          <li><a href="/">Home</a></li>
          <li><a href="/bilder-galerie/" class="current">Bilder-Galerie</a></li>
          <li><a href="/malstil/">Malstil</a></li>
          <li><a href="/biografie/">Biografie</a></li>
          <li><a href="/kontakt/">Kontakt</a></li>
        </ul>
      </nav>
    </div>
  </div>
</header>

<!-- Hero Section -->
<section class="hero">
  <div class="container">
    <div class="hero-content">
      <h1>Bilderauswahl</h1>
      <p class="hero-subtitle">Eine Sammlung meiner Werke aus verschiedenen Schaffensperioden</p>
    </div>
  </div>
</section>

<!-- Gallery Filter Section -->
<section class="gallery-filter">
  <div class="container">
    <div class="filter-buttons">
      <button class="filter-btn active" data-filter="all">Alle Bilder</button>
      <button class="filter-btn" data-filter="recent">Ab 2016 bis Gegenwart</button>
      <button class="filter-btn" data-filter="older">2015 und früher</button>
    </div>
  </div>
</section>

<!-- Gallery Section -->
<section class="gallery-section">
  <div class="container">
    <div class="gallery-grid" id="gallery-grid">
      <!-- Gallery items will be loaded here dynamically -->
    </div>

    <!-- Load More Button -->
    <div class="load-more-container">
      <button class="load-more-btn" id="load-more">Weitere Bilder laden</button>
    </div>

    <!-- Loading Spinner -->
    <div class="loading-spinner" id="loading-spinner">
      <div class="spinner"></div>
    </div>
  </div>
</section>

<!-- Lightbox -->
<div class="lightbox" id="lightbox">
  <div class="lightbox-overlay"></div>
  <div class="lightbox-container">
    <button class="lightbox-close" id="lightbox-close">&times;</button>
    <button class="lightbox-prev" id="lightbox-prev">‹</button>
    <button class="lightbox-next" id="lightbox-next">›</button>
    <div class="lightbox-content">
      <img class="lightbox-image" id="lightbox-image" src="" alt="">
      <div class="lightbox-info">
        <h3 class="lightbox-title" id="lightbox-title"></h3>
        <p class="lightbox-description" id="lightbox-description"></p>
      </div>
    </div>
    <div class="lightbox-counter">
      <span id="lightbox-counter">1 / 50</span>
    </div>
  </div>
</div>

<!-- Footer -->
<footer>
  <div class="container">
    <div class="footer-image">
      <img src="../images/schmet.png" alt="Schmetterling" loading="lazy">
    </div>
    <div class="footer-text">
      <p>&copy; 2020 Barbara Baumann | by <a href="http://www.evonet.ch">evoNET</a></p>
    </div>
  </div>
</footer>

<!-- Back to Top Button -->
<a href="#" class="back-to-top" title="Nach oben">↑</a>

<script>
// Configuration - Define possible image file extensions and folder structure
const config = {
  folders: {
    recent: '../images/gallery/recent/',  // Folder for images 2016+
    older: '../images/gallery/older/'    // Folder for images 2015-
  },
  extensions: ['jpg', 'jpeg', 'png', 'webp', 'gif'], // Supported image formats
  itemsPerPage: 12
};

// Gallery functionality with automatic folder scanning
class Gallery {
  constructor() {
    this.currentFilter = 'all';
    this.currentPage = 0;
    this.itemsPerPage = config.itemsPerPage;
    this.lightboxIndex = 0;
    this.allImages = [];
    this.filteredImages = [];

    this.init();
  }

  init() {
    this.bindEvents();
    this.scanFoldersForImages();
  }

  bindEvents() {
    // Filter buttons
    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        this.handleFilter(e.target.dataset.filter);
      });
    });

    // Load more button
    document.getElementById('load-more').addEventListener('click', () => {
      this.loadMoreImages();
    });

    // Lightbox events
    document.getElementById('lightbox-close').addEventListener('click', () => {
      this.closeLightbox();
    });

    document.getElementById('lightbox-prev').addEventListener('click', () => {
      this.showPrevImage();
    });

    document.getElementById('lightbox-next').addEventListener('click', () => {
      this.showNextImage();
    });

    // Close lightbox on overlay click
    document.querySelector('.lightbox-overlay').addEventListener('click', () => {
      this.closeLightbox();
    });

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (document.getElementById('lightbox').classList.contains('active')) {
        switch(e.key) {
          case 'Escape':
            this.closeLightbox();
            break;
          case 'ArrowLeft':
            this.showPrevImage();
            break;
          case 'ArrowRight':
            this.showNextImage();
            break;
        }
      }
    });
  }

  // Automatically scan folders for images
  async scanFoldersForImages() {
    this.showLoading();

    try {
      // Scan recent folder (2016+)
      const recentImages = await this.scanFolder('recent', config.folders.recent);

      // Scan older folder (2015-)
      const olderImages = await this.scanFolder('older', config.folders.older);

      // Combine all images
      this.allImages = [...recentImages, ...olderImages];

      // Sort by filename for consistent ordering
      this.allImages.sort((a, b) => a.filename.localeCompare(b.filename));

      this.loadImages();
    } catch (error) {
      console.error('Error scanning folders:', error);
      this.showErrorMessage();
    }
  }

  // Scan individual folder for images
  async scanFolder(category, folderPath) {
    const images = [];

    // Try to load common image files (this approach works for static hosting)
    // We'll generate potential filenames and check if they exist
    const commonFilenames = await this.generatePotentialFilenames();

    for (const filename of commonFilenames) {
      for (const ext of config.extensions) {
        const fullPath = `${folderPath}${filename}.${ext}`;

        if (await this.imageExists(fullPath)) {
          images.push({
            src: fullPath,
            category: category,
            filename: filename,
            title: this.generateTitle(filename)
          });
        }
      }
    }

    return images;
  }

  // Generate potential filenames to check for
  async generatePotentialFilenames() {
    // This is a simple approach - try common naming patterns
    const filenames = [];

    // Try numbered files (img1, img2, etc.)
    for (let i = 1; i <= 50; i++) {
      filenames.push(`img${i}`);
      filenames.push(`image${i}`);
      filenames.push(`bild${i}`);
      filenames.push(`werk${i}`);
      filenames.push(`${i.toString().padStart(2, '0')}`); // 01, 02, 03, etc.
    }

    // Try letter patterns (a, b, c, etc.)
    for (let i = 97; i <= 122; i++) { // a-z
      filenames.push(String.fromCharCode(i));
    }

    return filenames;
  }

  // Check if an image exists at the given URL
  async imageExists(url) {
    return new Promise((resolve) => {
      const img = new Image();
      img.onload = () => resolve(true);
      img.onerror = () => resolve(false);
      img.src = url;

      // Timeout after 2 seconds
      setTimeout(() => resolve(false), 2000);
    });
  }

  // Generate a title from filename
  generateTitle(filename) {
    // Remove numbers and make it more readable
    return filename.replace(/\d+/g, '').replace(/[_-]/g, ' ').trim() || 'Kunstwerk';
  }

  handleFilter(filter) {
    // Update active button
    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.classList.remove('active');
    });
    document.querySelector(`[data-filter="${filter}"]`).classList.add('active');

    this.currentFilter = filter;
    this.currentPage = 0;

    // Clear gallery
    document.getElementById('gallery-grid').innerHTML = '';

    this.loadImages();
  }

  getFilteredImages() {
    if (this.currentFilter === 'all') {
      return this.allImages;
    }
    return this.allImages.filter(img => img.category === this.currentFilter);
  }

  loadImages() {
    this.filteredImages = this.getFilteredImages();
    this.renderImages();
    this.hideLoading();
  }

  loadMoreImages() {
    this.currentPage++;
    this.showLoading();

    setTimeout(() => {
      this.renderImages();
      this.hideLoading();
    }, 300);
  }

  renderImages() {
    const startIndex = this.currentPage * this.itemsPerPage;
    const endIndex = startIndex + this.itemsPerPage;
    const imagesToShow = this.filteredImages.slice(startIndex, endIndex);

    const galleryGrid = document.getElementById('gallery-grid');

    if (imagesToShow.length === 0 && this.currentPage === 0) {
      this.showNoImagesMessage();
      return;
    }

    imagesToShow.forEach((image, index) => {
      const galleryItem = this.createGalleryItem(image, startIndex + index);
      galleryItem.classList.add('fade-in');
      galleryGrid.appendChild(galleryItem);

      // Trigger animation
      setTimeout(() => {
        galleryItem.classList.add('visible');
      }, 100 * (index + 1));
    });

    // Hide load more button if no more images
    const loadMoreBtn = document.getElementById('load-more');
    if (endIndex >= this.filteredImages.length) {
      loadMoreBtn.style.display = 'none';
    } else {
      loadMoreBtn.style.display = 'block';
    }
  }

  createGalleryItem(image, index) {
    const item = document.createElement('div');
    item.className = 'gallery-item';
    item.innerHTML = `
      <div class="gallery-image">
        <img src="${image.src}" alt="${image.title}" loading="lazy">
        <div class="image-overlay">
          <div class="overlay-content">
            <h3>${image.title}</h3>
            <p>${image.category === 'recent' ? '2016+' : '2015-'}</p>
            <button class="view-btn">Vergrößern</button>
          </div>
        </div>
      </div>
    `;

    // Add click event for lightbox
    item.addEventListener('click', () => {
      this.openLightbox(index);
    });

    return item;
  }

  openLightbox(index) {
    this.lightboxIndex = index;
    const image = this.filteredImages[index];

    document.getElementById('lightbox-image').src = image.src;
    document.getElementById('lightbox-title').textContent = image.title;
    document.getElementById('lightbox-description').textContent = `Kategorie: ${image.category === 'recent' ? 'Ab 2016 bis Gegenwart' : '2015 und früher'}`;
    document.getElementById('lightbox-counter').textContent = `${index + 1} / ${this.filteredImages.length}`;

    document.getElementById('lightbox').classList.add('active');
    document.body.style.overflow = 'hidden';
  }

  closeLightbox() {
    document.getElementById('lightbox').classList.remove('active');
    document.body.style.overflow = '';
  }

  showPrevImage() {
    if (this.lightboxIndex > 0) {
      this.lightboxIndex--;
      this.updateLightboxImage();
    } else {
      // Loop to last image
      this.lightboxIndex = this.filteredImages.length - 1;
      this.updateLightboxImage();
    }
  }

  showNextImage() {
    if (this.lightboxIndex < this.filteredImages.length - 1) {
      this.lightboxIndex++;
      this.updateLightboxImage();
    } else {
      // Loop to first image
      this.lightboxIndex = 0;
      this.updateLightboxImage();
    }
  }

  updateLightboxImage() {
    const image = this.filteredImages[this.lightboxIndex];

    document.getElementById('lightbox-image').src = image.src;
    document.getElementById('lightbox-title').textContent = image.title;
    document.getElementById('lightbox-description').textContent = `Kategorie: ${image.category === 'recent' ? 'Ab 2016 bis Gegenwart' : '2015 und früher'}`;
    document.getElementById('lightbox-counter').textContent = `${this.lightboxIndex + 1} / ${this.filteredImages.length}`;
  }

  showLoading() {
    document.getElementById('loading-spinner').classList.add('visible');
  }

  hideLoading() {
    document.getElementById('loading-spinner').classList.remove('visible');
  }

  showErrorMessage() {
    const galleryGrid = document.getElementById('gallery-grid');
    galleryGrid.innerHTML = `
      <div class="error-message">
        <h3>Fehler beim Laden der Bilder</h3>
        <p>Die Bildergalerie konnte nicht geladen werden. Bitte versuchen Sie es später erneut.</p>
      </div>
    `;
    this.hideLoading();
  }

  showNoImagesMessage() {
    const galleryGrid = document.getElementById('gallery-grid');
    const categoryText = this.currentFilter === 'all' ? 'in dieser Galerie' :
                        this.currentFilter === 'recent' ? 'in der Kategorie "Ab 2016 bis Gegenwart"' :
                        'in der Kategorie "2015 und früher"';

    galleryGrid.innerHTML = `
      <div class="no-images-message">
        <h3>Keine Bilder gefunden</h3>
        <p>Momentan sind keine Bilder ${categoryText} verfügbar.</p>
      </div>
    `;
  }
}

// Initialize gallery when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
  new Gallery();
});
</script>

<script src="../script.js"></script>

</body>
</html>